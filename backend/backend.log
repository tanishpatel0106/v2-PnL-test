2025-07-04 12:49:04,892 INFO werkzeug - 127.0.0.1 - - [04/Jul/2025 12:49:04] "GET /company_codes HTTP/1.1" 200 -
2025-07-04 12:49:05,125 INFO werkzeug - 127.0.0.1 - - [04/Jul/2025 12:49:05] "GET /company_codes HTTP/1.1" 200 -
2025-07-04 12:49:05,648 INFO werkzeug - 127.0.0.1 - - [04/Jul/2025 12:49:05] "GET /company_codes HTTP/1.1" 200 -
2025-07-04 12:49:05,969 INFO werkzeug - 127.0.0.1 - - [04/Jul/2025 12:49:05] "GET /company_codes HTTP/1.1" 200 -
2025-07-04 12:55:34,034 INFO werkzeug - 127.0.0.1 - - [04/Jul/2025 12:55:34] "GET /company_codes HTTP/1.1" 200 -
2025-07-04 12:55:34,295 INFO werkzeug - 127.0.0.1 - - [04/Jul/2025 12:55:34] "GET /company_codes HTTP/1.1" 200 -
2025-07-04 12:55:40,288 INFO werkzeug - 127.0.0.1 - - [04/Jul/2025 12:55:40] "GET /monthly/company_codes HTTP/1.1" 200 -
2025-07-04 12:55:40,745 INFO werkzeug - 127.0.0.1 - - [04/Jul/2025 12:55:40] "GET /company_codes HTTP/1.1" 200 -
2025-07-04 12:55:40,870 INFO werkzeug - 127.0.0.1 - - [04/Jul/2025 12:55:40] "GET /company_codes HTTP/1.1" 200 -
2025-07-04 12:55:41,135 INFO werkzeug - 127.0.0.1 - - [04/Jul/2025 12:55:41] "GET /monthly/company_codes HTTP/1.1" 200 -
2025-07-04 12:55:41,717 INFO werkzeug - 127.0.0.1 - - [04/Jul/2025 12:55:41] "GET /company_codes HTTP/1.1" 200 -
2025-07-04 12:55:42,036 INFO werkzeug - 127.0.0.1 - - [04/Jul/2025 12:55:42] "GET /company_codes HTTP/1.1" 200 -
2025-07-04 13:01:33,459 INFO werkzeug - 127.0.0.1 - - [04/Jul/2025 13:01:33] "GET /company_codes HTTP/1.1" 200 -
2025-07-04 13:01:33,724 INFO werkzeug - 127.0.0.1 - - [04/Jul/2025 13:01:33] "GET /company_codes HTTP/1.1" 200 -
2025-07-04 13:02:02,458 INFO werkzeug - 127.0.0.1 - - [04/Jul/2025 13:02:02] "GET /company_codes HTTP/1.1" 200 -
2025-07-04 13:02:02,778 INFO werkzeug - 127.0.0.1 - - [04/Jul/2025 13:02:02] "GET /company_codes HTTP/1.1" 200 -
2025-07-04 13:02:09,823 INFO werkzeug - 127.0.0.1 - - [04/Jul/2025 13:02:09] "GET /company_codes HTTP/1.1" 200 -
2025-07-04 13:02:10,085 INFO werkzeug - 127.0.0.1 - - [04/Jul/2025 13:02:10] "GET /company_codes HTTP/1.1" 200 -
2025-07-04 13:06:09,056 INFO werkzeug - 127.0.0.1 - - [04/Jul/2025 13:06:09] "GET /company_codes HTTP/1.1" 200 -
2025-07-04 13:06:09,314 INFO werkzeug - 127.0.0.1 - - [04/Jul/2025 13:06:09] "GET /company_codes HTTP/1.1" 200 -
2025-07-04 13:06:10,209 INFO werkzeug - 127.0.0.1 - - [04/Jul/2025 13:06:10] "GET /company_codes HTTP/1.1" 200 -
2025-07-04 13:06:10,521 INFO werkzeug - 127.0.0.1 - - [04/Jul/2025 13:06:10] "GET /company_codes HTTP/1.1" 200 -
2025-07-14 14:47:53,799 INFO werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-07-14 14:47:53,799 INFO werkzeug - [33mPress CTRL+C to quit[0m
2025-07-14 14:49:15,738 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 14:49:15] "GET /company_codes HTTP/1.1" 200 -
2025-07-14 14:49:16,299 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 14:49:16] "GET /company_codes HTTP/1.1" 200 -
2025-07-14 14:49:17,181 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 14:49:17] "GET /company_codes HTTP/1.1" 200 -
2025-07-14 14:49:17,736 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 14:49:17] "GET /company_codes HTTP/1.1" 200 -
2025-07-14 14:49:18,850 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 14:49:18] "GET /company_codes HTTP/1.1" 200 -
2025-07-14 14:49:19,394 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 14:49:19] "GET /company_codes HTTP/1.1" 200 -
2025-07-14 14:49:25,489 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 14:49:25] "GET /site_codes?company_code=C077 HTTP/1.1" 200 -
2025-07-14 14:49:49,734 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 14:49:49] "GET /forecast/income?company=C077&site=L077&year=2025&period=P6 HTTP/1.1" 200 -
2025-07-14 14:50:05,538 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 14:50:05] "GET /forecast/cogs?company=C077&site=L077&year=2025&period=P6 HTTP/1.1" 200 -
2025-07-14 14:50:22,246 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 14:50:22] "GET /forecast/expense?company=C077&site=L077&year=2025&period=P6 HTTP/1.1" 200 -
2025-07-14 14:50:45,093 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 14:50:45] "GET /forecast/income?company=C077&site=L077&year=2025&period=P5 HTTP/1.1" 200 -
2025-07-14 14:51:04,877 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 14:51:04] "GET /forecast/cogs?company=C077&site=L077&year=2025&period=P5 HTTP/1.1" 200 -
2025-07-14 14:51:35,422 WARNING tensorflow - From C:\Users\Paperchase\anaconda3\Lib\site-packages\keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

2025-07-14 14:51:50,906 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 14:51:50] "GET /forecast/expense?company=C077&site=L077&year=2025&period=P5 HTTP/1.1" 200 -
2025-07-14 15:38:28,495 INFO werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-07-14 15:38:28,495 INFO werkzeug - [33mPress CTRL+C to quit[0m
2025-07-14 15:38:34,741 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:38:34] "GET /company_codes HTTP/1.1" 200 -
2025-07-14 15:38:35,271 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:38:35] "GET /company_codes HTTP/1.1" 200 -
2025-07-14 15:38:36,119 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:38:36] "GET /company_codes HTTP/1.1" 200 -
2025-07-14 15:38:36,661 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:38:36] "GET /company_codes HTTP/1.1" 200 -
2025-07-14 15:38:37,509 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:38:37] "GET /company_codes HTTP/1.1" 200 -
2025-07-14 15:38:42,157 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:38:42] "GET /site_codes?company_code=C077 HTTP/1.1" 200 -
2025-07-14 15:39:05,482 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:39:05] "GET /forecast/income?company=C077&site=L077&year=2025&period=P6 HTTP/1.1" 200 -
2025-07-14 15:39:22,131 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:39:22] "GET /forecast/cogs?company=C077&site=L077&year=2025&period=P6 HTTP/1.1" 200 -
2025-07-14 15:39:39,341 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:39:39] "GET /forecast/expense?company=C077&site=L077&year=2025&period=P6 HTTP/1.1" 200 -
2025-07-14 15:40:51,181 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:40:51] "GET /company_codes HTTP/1.1" 200 -
2025-07-14 15:40:52,396 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:40:52] "GET /company_codes HTTP/1.1" 200 -
2025-07-14 15:40:53,466 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:40:53] "GET /site_codes?company_code=C077 HTTP/1.1" 200 -
2025-07-14 15:41:00,819 ERROR app - Exception on /forecast/expense [GET]
Traceback (most recent call last):
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask\app.py", line 2529, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask\app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask_cors\extension.py", line 178, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask\app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask\app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\Documents\v2-PnL-test\backend\app.py", line 659, in _endpoint
    existing = load_existing_forecast(field, company, site, year, period)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\Documents\v2-PnL-test\backend\app.py", line 599, in load_existing_forecast
    df["PeriodInt"] = df["Forecasted_For_Period"].str.extract(r"P(\d+)").astype(int)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\generic.py", line 6240, in astype
    new_data = self._mgr.astype(dtype=dtype, copy=copy, errors=errors)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\internals\managers.py", line 448, in astype
    return self.apply("astype", dtype=dtype, copy=copy, errors=errors)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\internals\managers.py", line 352, in apply
    applied = getattr(b, f)(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\internals\blocks.py", line 526, in astype
    new_values = astype_array_safe(values, dtype, copy=copy, errors=errors)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\dtypes\astype.py", line 299, in astype_array_safe
    new_values = astype_array(values, dtype, copy=copy)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\dtypes\astype.py", line 230, in astype_array
    values = astype_nansafe(values, dtype, copy=copy)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\dtypes\astype.py", line 170, in astype_nansafe
    return arr.astype(dtype, copy=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: cannot convert float NaN to integer
2025-07-14 15:41:00,919 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:41:00] "[35m[1mGET /forecast/expense?company=C077&site=L077&year=2025&period=P6 HTTP/1.1[0m" 500 -
2025-07-14 15:41:01,031 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:41:01] "GET /forecast/income_actuals?company=C077&site=L077&year=2025&period=P6 HTTP/1.1" 200 -
2025-07-14 15:41:01,514 ERROR app - Exception on /forecast/cogs [GET]
Traceback (most recent call last):
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask\app.py", line 2529, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask\app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask_cors\extension.py", line 178, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask\app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask\app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\Documents\v2-PnL-test\backend\app.py", line 659, in _endpoint
    existing = load_existing_forecast(field, company, site, year, period)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\Documents\v2-PnL-test\backend\app.py", line 599, in load_existing_forecast
    df["PeriodInt"] = df["Forecasted_For_Period"].str.extract(r"P(\d+)").astype(int)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\generic.py", line 6240, in astype
    new_data = self._mgr.astype(dtype=dtype, copy=copy, errors=errors)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\internals\managers.py", line 448, in astype
    return self.apply("astype", dtype=dtype, copy=copy, errors=errors)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\internals\managers.py", line 352, in apply
    applied = getattr(b, f)(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\internals\blocks.py", line 526, in astype
    new_values = astype_array_safe(values, dtype, copy=copy, errors=errors)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\dtypes\astype.py", line 299, in astype_array_safe
    new_values = astype_array(values, dtype, copy=copy)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\dtypes\astype.py", line 230, in astype_array
    values = astype_nansafe(values, dtype, copy=copy)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\dtypes\astype.py", line 170, in astype_nansafe
    return arr.astype(dtype, copy=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: cannot convert float NaN to integer
2025-07-14 15:41:01,520 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:41:01] "[35m[1mGET /forecast/cogs?company=C077&site=L077&year=2025&period=P6 HTTP/1.1[0m" 500 -
2025-07-14 15:41:01,563 ERROR app - Exception on /forecast/income [GET]
Traceback (most recent call last):
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask\app.py", line 2529, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask\app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask_cors\extension.py", line 178, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask\app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask\app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\Documents\v2-PnL-test\backend\app.py", line 659, in _endpoint
    existing = load_existing_forecast(field, company, site, year, period)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\Documents\v2-PnL-test\backend\app.py", line 599, in load_existing_forecast
    df["PeriodInt"] = df["Forecasted_For_Period"].str.extract(r"P(\d+)").astype(int)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\generic.py", line 6240, in astype
    new_data = self._mgr.astype(dtype=dtype, copy=copy, errors=errors)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\internals\managers.py", line 448, in astype
    return self.apply("astype", dtype=dtype, copy=copy, errors=errors)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\internals\managers.py", line 352, in apply
    applied = getattr(b, f)(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\internals\blocks.py", line 526, in astype
    new_values = astype_array_safe(values, dtype, copy=copy, errors=errors)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\dtypes\astype.py", line 299, in astype_array_safe
    new_values = astype_array(values, dtype, copy=copy)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\dtypes\astype.py", line 230, in astype_array
    values = astype_nansafe(values, dtype, copy=copy)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\dtypes\astype.py", line 170, in astype_nansafe
    return arr.astype(dtype, copy=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: cannot convert float NaN to integer
2025-07-14 15:41:01,568 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:41:01] "[35m[1mGET /forecast/income?company=C077&site=L077&year=2025&period=P6 HTTP/1.1[0m" 500 -
2025-07-14 15:41:01,774 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:41:01] "GET /forecast/expense_actuals?company=C077&site=L077&year=2025&period=P6 HTTP/1.1" 200 -
2025-07-14 15:41:01,853 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:41:01] "GET /forecast/cogs_actuals?company=C077&site=L077&year=2025&period=P6 HTTP/1.1" 200 -
2025-07-14 15:41:01,907 ERROR app - Exception on /forecast/expense [GET]
Traceback (most recent call last):
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask\app.py", line 2529, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask\app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask_cors\extension.py", line 178, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask\app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask\app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\Documents\v2-PnL-test\backend\app.py", line 659, in _endpoint
    existing = load_existing_forecast(field, company, site, year, period)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\Documents\v2-PnL-test\backend\app.py", line 599, in load_existing_forecast
    df["PeriodInt"] = df["Forecasted_For_Period"].str.extract(r"P(\d+)").astype(int)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\generic.py", line 6240, in astype
    new_data = self._mgr.astype(dtype=dtype, copy=copy, errors=errors)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\internals\managers.py", line 448, in astype
    return self.apply("astype", dtype=dtype, copy=copy, errors=errors)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\internals\managers.py", line 352, in apply
    applied = getattr(b, f)(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\internals\blocks.py", line 526, in astype
    new_values = astype_array_safe(values, dtype, copy=copy, errors=errors)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\dtypes\astype.py", line 299, in astype_array_safe
    new_values = astype_array(values, dtype, copy=copy)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\dtypes\astype.py", line 230, in astype_array
    values = astype_nansafe(values, dtype, copy=copy)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\dtypes\astype.py", line 170, in astype_nansafe
    return arr.astype(dtype, copy=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: cannot convert float NaN to integer
2025-07-14 15:41:01,913 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:41:01] "[35m[1mGET /forecast/expense?company=C077&site=L077&year=2025&period=P6 HTTP/1.1[0m" 500 -
2025-07-14 15:41:02,520 ERROR app - Exception on /forecast/cogs [GET]
Traceback (most recent call last):
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask\app.py", line 2529, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask\app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask_cors\extension.py", line 178, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask\app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask\app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\Documents\v2-PnL-test\backend\app.py", line 659, in _endpoint
    existing = load_existing_forecast(field, company, site, year, period)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\Documents\v2-PnL-test\backend\app.py", line 599, in load_existing_forecast
    df["PeriodInt"] = df["Forecasted_For_Period"].str.extract(r"P(\d+)").astype(int)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\generic.py", line 6240, in astype
    new_data = self._mgr.astype(dtype=dtype, copy=copy, errors=errors)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\internals\managers.py", line 448, in astype
    return self.apply("astype", dtype=dtype, copy=copy, errors=errors)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\internals\managers.py", line 352, in apply
    applied = getattr(b, f)(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\internals\blocks.py", line 526, in astype
    new_values = astype_array_safe(values, dtype, copy=copy, errors=errors)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\dtypes\astype.py", line 299, in astype_array_safe
    new_values = astype_array(values, dtype, copy=copy)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\dtypes\astype.py", line 230, in astype_array
    values = astype_nansafe(values, dtype, copy=copy)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\dtypes\astype.py", line 170, in astype_nansafe
    return arr.astype(dtype, copy=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: cannot convert float NaN to integer
2025-07-14 15:41:02,525 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:41:02] "[35m[1mGET /forecast/cogs?company=C077&site=L077&year=2025&period=P6 HTTP/1.1[0m" 500 -
2025-07-14 15:41:02,574 ERROR app - Exception on /forecast/income [GET]
Traceback (most recent call last):
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask\app.py", line 2529, in wsgi_app
    response = self.full_dispatch_request()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask\app.py", line 1825, in full_dispatch_request
    rv = self.handle_user_exception(e)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask_cors\extension.py", line 178, in wrapped_function
    return cors_after_request(app.make_response(f(*args, **kwargs)))
                                                ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask\app.py", line 1823, in full_dispatch_request
    rv = self.dispatch_request()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\flask\app.py", line 1799, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\Documents\v2-PnL-test\backend\app.py", line 659, in _endpoint
    existing = load_existing_forecast(field, company, site, year, period)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\Documents\v2-PnL-test\backend\app.py", line 599, in load_existing_forecast
    df["PeriodInt"] = df["Forecasted_For_Period"].str.extract(r"P(\d+)").astype(int)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\generic.py", line 6240, in astype
    new_data = self._mgr.astype(dtype=dtype, copy=copy, errors=errors)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\internals\managers.py", line 448, in astype
    return self.apply("astype", dtype=dtype, copy=copy, errors=errors)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\internals\managers.py", line 352, in apply
    applied = getattr(b, f)(**kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\internals\blocks.py", line 526, in astype
    new_values = astype_array_safe(values, dtype, copy=copy, errors=errors)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\dtypes\astype.py", line 299, in astype_array_safe
    new_values = astype_array(values, dtype, copy=copy)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\dtypes\astype.py", line 230, in astype_array
    values = astype_nansafe(values, dtype, copy=copy)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Paperchase\anaconda3\Lib\site-packages\pandas\core\dtypes\astype.py", line 170, in astype_nansafe
    return arr.astype(dtype, copy=True)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: cannot convert float NaN to integer
2025-07-14 15:41:02,579 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:41:02] "[35m[1mGET /forecast/income?company=C077&site=L077&year=2025&period=P6 HTTP/1.1[0m" 500 -
2025-07-14 15:43:53,981 INFO werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:5000
2025-07-14 15:43:53,981 INFO werkzeug - [33mPress CTRL+C to quit[0m
2025-07-14 15:44:04,621 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:44:04] "GET /forecast/cogs?company=C077&site=L077&year=2025&period=P6 HTTP/1.1" 200 -
2025-07-14 15:44:04,633 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:44:04] "GET /forecast/expense?company=C077&site=L077&year=2025&period=P6 HTTP/1.1" 200 -
2025-07-14 15:44:04,651 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:44:04] "GET /forecast/income?company=C077&site=L077&year=2025&period=P6 HTTP/1.1" 200 -
2025-07-14 15:44:05,260 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:44:05] "GET /forecast/income_actuals?company=C077&site=L077&year=2025&period=P6 HTTP/1.1" 200 -
2025-07-14 15:44:05,494 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:44:05] "GET /forecast/expense_actuals?company=C077&site=L077&year=2025&period=P6 HTTP/1.1" 200 -
2025-07-14 15:44:05,608 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:44:05] "GET /forecast/expense?company=C077&site=L077&year=2025&period=P6 HTTP/1.1" 200 -
2025-07-14 15:44:05,653 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:44:05] "GET /forecast/cogs?company=C077&site=L077&year=2025&period=P6 HTTP/1.1" 200 -
2025-07-14 15:44:06,347 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:44:06] "GET /forecast/cogs_actuals?company=C077&site=L077&year=2025&period=P6 HTTP/1.1" 200 -
2025-07-14 15:44:06,380 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 15:44:06] "GET /forecast/income?company=C077&site=L077&year=2025&period=P6 HTTP/1.1" 200 -
2025-07-14 16:04:17,400 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 16:04:17] "GET /company_codes HTTP/1.1" 200 -
2025-07-14 16:04:17,952 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 16:04:17] "GET /company_codes HTTP/1.1" 200 -
2025-07-14 16:04:32,277 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 16:04:32] "GET /site_codes?company_code=C077 HTTP/1.1" 200 -
2025-07-14 16:04:58,914 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 16:04:58] "GET /forecast/income?company=C077&site=L077&year=2025&period=P5 HTTP/1.1" 200 -
2025-07-14 16:05:16,166 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 16:05:16] "GET /forecast/cogs?company=C077&site=L077&year=2025&period=P5 HTTP/1.1" 200 -
2025-07-14 16:05:43,521 WARNING tensorflow - From C:\Users\Paperchase\anaconda3\Lib\site-packages\keras\src\losses.py:2976: The name tf.losses.sparse_softmax_cross_entropy is deprecated. Please use tf.compat.v1.losses.sparse_softmax_cross_entropy instead.

2025-07-14 16:05:56,422 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 16:05:56] "GET /forecast/expense?company=C077&site=L077&year=2025&period=P5 HTTP/1.1" 200 -
2025-07-14 18:02:12,905 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 18:02:12] "GET /company_codes HTTP/1.1" 200 -
2025-07-14 18:02:13,444 INFO werkzeug - 127.0.0.1 - - [14/Jul/2025 18:02:13] "GET /company_codes HTTP/1.1" 200 -
2025-07-15 11:33:50,130 INFO werkzeug - 127.0.0.1 - - [15/Jul/2025 11:33:50] "GET /site_codes?company_code=C077 HTTP/1.1" 200 -
